<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PVAMU ITS - Change Management Request</title>
    <style>
        :root {
  /* Primitive Color Tokens */
  --color-white: rgba(255, 255, 255, 1);
  --color-black: rgba(0, 0, 0, 1);
  --color-cream-50: rgba(252, 252, 249, 1);
  --color-cream-100: rgba(255, 255, 253, 1);
  --color-gray-200: rgba(245, 245, 245, 1);
  --color-gray-300: rgba(167, 169, 169, 1);
  --color-gray-400: rgba(119, 124, 124, 1);
  --color-slate-500: rgba(98, 108, 113, 1);
  --color-brown-600: rgba(94, 82, 64, 1);
  --color-charcoal-700: rgba(31, 33, 33, 1);
  --color-charcoal-800: rgba(38, 40, 40, 1);
  --color-slate-900: rgba(19, 52, 59, 1);
  --color-teal-300: rgba(50, 184, 198, 1);
  --color-teal-400: rgba(45, 166, 178, 1);
  --color-teal-500: rgba(33, 128, 141, 1);
  --color-teal-600: rgba(29, 116, 128, 1);
  --color-teal-700: rgba(26, 104, 115, 1);
  --color-teal-800: rgba(41, 150, 161, 1);
  --color-red-400: rgba(255, 84, 89, 1);
  --color-red-500: rgba(192, 21, 47, 1);
  --color-orange-400: rgba(230, 129, 97, 1);
  --color-orange-500: rgba(168, 75, 47, 1);

  /* RGB versions for opacity control */
  --color-brown-600-rgb: 94, 82, 64;
  --color-teal-500-rgb: 33, 128, 141;
  --color-slate-900-rgb: 19, 52, 59;
  --color-slate-500-rgb: 98, 108, 113;
  --color-red-500-rgb: 192, 21, 47;
  --color-red-400-rgb: 255, 84, 89;
  --color-orange-500-rgb: 168, 75, 47;
  --color-orange-400-rgb: 230, 129, 97;

  /* Semantic Color Tokens (Light Mode) */
  --color-background: var(--color-cream-50);
  --color-surface: var(--color-cream-100);
  --color-text: var(--color-slate-900);
  --color-text-secondary: var(--color-slate-500);
  --color-primary: var(--color-teal-500);
  --color-primary-hover: var(--color-teal-600);
  --color-primary-active: var(--color-teal-700);
  --color-secondary: rgba(var(--color-brown-600-rgb), 0.12);
  --color-secondary-hover: rgba(var(--color-brown-600-rgb), 0.2);
  --color-secondary-active: rgba(var(--color-brown-600-rgb), 0.25);
  --color-border: rgba(var(--color-brown-600-rgb), 0.2);
  --color-btn-primary-text: var(--color-cream-50);
  --color-card-border: rgba(var(--color-brown-600-rgb), 0.12);
  --color-card-border-inner: rgba(var(--color-brown-600-rgb), 0.12);
  --color-error: var(--color-red-500);
  --color-success: var(--color-teal-500);
  --color-warning: var(--color-orange-500);
  --color-info: var(--color-slate-500);
  --color-focus-ring: rgba(var(--color-teal-500-rgb), 0.4);
  --color-select-caret: rgba(var(--color-slate-900-rgb), 0.8);

  /* Typography */
  --font-family-base: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
  --font-size-xs: 11px;
  --font-size-sm: 12px;
  --font-size-base: 14px;
  --font-size-md: 14px;
  --font-size-lg: 16px;
  --font-size-xl: 18px;
  --font-size-2xl: 20px;
  --font-size-3xl: 24px;
  --font-size-4xl: 30px;
  --font-weight-normal: 400;
  --font-weight-medium: 500;
  --font-weight-semibold: 550;
  --font-weight-bold: 600;
  --line-height-tight: 1.2;
  --line-height-normal: 1.5;
  --letter-spacing-tight: -0.01em;

  /* Spacing */
  --space-4: 4px;
  --space-6: 6px;
  --space-8: 8px;
  --space-10: 10px;
  --space-12: 12px;
  --space-16: 16px;
  --space-20: 20px;
  --space-24: 24px;
  --space-32: 32px;

  /* Border Radius */
  --radius-sm: 6px;
  --radius-base: 8px;
  --radius-md: 10px;
  --radius-lg: 12px;
  --radius-full: 9999px;

  /* Shadows */
  --shadow-xs: 0 1px 2px rgba(0, 0, 0, 0.02);
  --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.04), 0 1px 2px rgba(0, 0, 0, 0.02);
  --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.04), 0 2px 4px -1px rgba(0, 0, 0, 0.02);
  --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.04), 0 4px 6px -2px rgba(0, 0, 0, 0.02);

  /* Animation */
  --duration-fast: 150ms;
  --duration-normal: 250ms;
  --ease-standard: cubic-bezier(0.16, 1, 0.3, 1);
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: var(--font-family-base);
    background-color: var(--color-background);
    color: var(--color-text);
    line-height: var(--line-height-normal);
    font-size: var(--font-size-base);
    padding: var(--space-24);
}

.container {
    max-width: 900px;
    margin: 0 auto;
    background-color: var(--color-surface);
    padding: var(--space-32);
    border-radius: var(--radius-lg);
    box-shadow: var(--shadow-lg);
}

.header {
    text-align: center;
    margin-bottom: var(--space-32);
    padding-bottom: var(--space-24);
    border-bottom: 2px solid var(--color-border);
}

.header h1 {
    font-size: var(--font-size-3xl);
    font-weight: var(--font-weight-bold);
    color: var(--color-text);
    margin-bottom: var(--space-8);
}

.header p {
    color: var(--color-text-secondary);
    font-size: var(--font-size-md);
}

.section {
    margin-bottom: var(--space-32);
    padding: var(--space-24);
    background-color: var(--color-surface);
    border: 1px solid var(--color-card-border);
    border-radius: var(--radius-md);
}

.section-title {
    font-size: var(--font-size-xl);
    font-weight: var(--font-weight-semibold);
    color: var(--color-text);
    margin-bottom: var(--space-16);
    padding-bottom: var(--space-8);
    border-bottom: 1px solid var(--color-card-border-inner);
}

.section-subtitle {
    font-size: var(--font-size-sm);
    color: var(--color-text-secondary);
    margin-bottom: var(--space-12);
    font-weight: var(--font-weight-medium);
}

.form-group {
    margin-bottom: var(--space-20);
}

.form-label {
    display: block;
    font-weight: var(--font-weight-medium);
    margin-bottom: var(--space-8);
    color: var(--color-text);
    font-size: var(--font-size-md);
}

.form-label.required::after {
    content: " *";
    color: var(--color-error);
}

.form-control {
    width: 100%;
    padding: var(--space-12);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-base);
    font-size: var(--font-size-base);
    font-family: var(--font-family-base);
    color: var(--color-text);
    background-color: var(--color-surface);
    transition: border-color var(--duration-fast) var(--ease-standard);
}

.form-control:focus {
    outline: none;
    border-color: var(--color-primary);
    box-shadow: 0 0 0 3px var(--color-focus-ring);
}

.form-control.error {
    border-color: var(--color-error);
}

textarea.form-control {
    min-height: 100px;
    resize: vertical;
}

.checkbox-group, .radio-group {
    display: flex;
    flex-direction: column;
    gap: var(--space-12);
}

.checkbox-item, .radio-item {
    display: flex;
    align-items: center;
    gap: var(--space-8);
}

.checkbox-item input[type="checkbox"],
.radio-item input[type="radio"] {
    width: 18px;
    height: 18px;
    cursor: pointer;
    accent-color: var(--color-primary);
}

.checkbox-item label,
.radio-item label {
    cursor: pointer;
    font-size: var(--font-size-md);
}

.otro-input {
    margin-left: var(--space-32);
    margin-top: var(--space-8);
    display: none;
}

.otro-input.visible {
    display: block;
}

.char-counter {
    font-size: var(--font-size-sm);
    color: var(--color-text-secondary);
    margin-top: var(--space-4);
    text-align: right;
}

.char-counter.warning {
    color: var(--color-warning);
}

.error-message {
    color: var(--color-error);
    font-size: var(--font-size-sm);
    margin-top: var(--space-4);
    display: none;
}

.error-message.visible {
    display: block;
}

.signature-grid {
    display: grid;
    gap: var(--space-20);
}

.signature-block {
    padding: var(--space-16);
    background-color: var(--color-secondary);
    border-radius: var(--radius-base);
    border: 1px solid var(--color-card-border);
}

.signature-block-title {
    font-weight: var(--font-weight-semibold);
    margin-bottom: var(--space-12);
    color: var(--color-text);
}

.signature-fields {
    display: grid;
    grid-template-columns: 2fr 1fr 1fr;
    gap: var(--space-12);
}

.button-group {
    display: flex;
    gap: var(--space-16);
    margin-top: var(--space-32);
    flex-wrap: wrap;
}

.btn {
    padding: var(--space-12) var(--space-24);
    border: none;
    border-radius: var(--radius-base);
    font-size: var(--font-size-base);
    font-weight: var(--font-weight-medium);
    cursor: pointer;
    transition: all var(--duration-normal) var(--ease-standard);
    font-family: var(--font-family-base);
}

.btn-primary {
    background-color: var(--color-primary);
    color: var(--color-btn-primary-text);
}

.btn-primary:hover {
    background-color: var(--color-primary-hover);
}

.btn-primary:active {
    background-color: var(--color-primary-active);
}

.btn-secondary {
    background-color: var(--color-secondary);
    color: var(--color-text);
    border: 1px solid var(--color-border);
}

.btn-secondary:hover {
    background-color: var(--color-secondary-hover);
}

.btn-outline {
    background-color: transparent;
    color: var(--color-text);
    border: 1px solid var(--color-border);
}

.btn-outline:hover {
    background-color: var(--color-secondary);
}

.btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

.modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
    z-index: 1000;
    align-items: center;
    justify-content: center;
    padding: var(--space-24);
}

.modal.visible {
    display: flex;
}

.modal-content {
    background-color: var(--color-surface);
    padding: var(--space-32);
    border-radius: var(--radius-lg);
    max-width: 800px;
    max-height: 90vh;
    overflow-y: auto;
    box-shadow: var(--shadow-lg);
    width: 100%;
}

.modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: var(--space-24);
    padding-bottom: var(--space-16);
    border-bottom: 1px solid var(--color-border);
}

.modal-header h2 {
    font-size: var(--font-size-2xl);
    font-weight: var(--font-weight-semibold);
}

.close-btn {
    background: none;
    border: none;
    font-size: var(--font-size-2xl);
    cursor: pointer;
    color: var(--color-text-secondary);
    padding: var(--space-4);
}

.close-btn:hover {
    color: var(--color-text);
}

.success-message {
    background-color: rgba(var(--color-teal-500-rgb), 0.1);
    border: 1px solid var(--color-success);
    padding: var(--space-20);
    border-radius: var(--radius-base);
    margin-bottom: var(--space-24);
}

.success-message h3 {
    color: var(--color-success);
    margin-bottom: var(--space-12);
    font-size: var(--font-size-lg);
}

.github-preview {
    background-color: var(--color-secondary);
    padding: var(--space-16);
    border-radius: var(--radius-base);
    margin-top: var(--space-16);
    border: 1px solid var(--color-border);
}

.github-preview h4 {
    margin-bottom: var(--space-8);
    font-size: var(--font-size-md);
}

.github-preview pre {
    background-color: var(--color-surface);
    padding: var(--space-12);
    border-radius: var(--radius-sm);
    overflow-x: auto;
    font-size: var(--font-size-sm);
    border: 1px solid var(--color-border);
}

.submissions-list {
    display: none;
    margin-top: var(--space-24);
    padding: var(--space-24);
    background-color: var(--color-secondary);
    border-radius: var(--radius-md);
    border: 1px solid var(--color-card-border);
}

.submissions-list.visible {
    display: block;
}

.submission-item {
    background-color: var(--color-surface);
    padding: var(--space-16);
    margin-bottom: var(--space-12);
    border-radius: var(--radius-base);
    border: 1px solid var(--color-border);
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: var(--space-16);
}

.submission-info {
    flex: 1;
}

.submission-info strong {
    display: block;
    margin-bottom: var(--space-4);
}

.submission-info small {
    color: var(--color-text-secondary);
    font-size: var(--font-size-sm);
}

.collapsible {
    margin-top: var(--space-24);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-base);
    overflow: hidden;
}

.collapsible-header {
    background-color: var(--color-secondary);
    padding: var(--space-16);
    cursor: pointer;
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-weight: var(--font-weight-semibold);
}

.collapsible-header:hover {
    background-color: var(--color-secondary-hover);
}

.collapsible-content {
    display: none;
    padding: var(--space-20);
    background-color: var(--color-surface);
}

.collapsible-content.visible {
    display: block;
}

.code-block {
    background-color: var(--color-charcoal-700);
    color: var(--color-gray-200);
    padding: var(--space-16);
    border-radius: var(--radius-base);
    overflow-x: auto;
    font-family: monospace;
    font-size: var(--font-size-sm);
    margin: var(--space-12) 0;
}

.note {
    background-color: rgba(var(--color-teal-500-rgb), 0.08);
    padding: var(--space-16);
    border-radius: var(--radius-base);
    margin-top: var(--space-32);
    border-left: 3px solid var(--color-primary);
    font-size: var(--font-size-sm);
    color: var(--color-text-secondary);
}

.empty-state {
    text-align: center;
    padding: var(--space-32);
    color: var(--color-text-secondary);
}

@media (max-width: 768px) {
    body {
        padding: var(--space-12);
    }
    
    .container {
        padding: var(--space-20);
    }
    
    .signature-fields {
        grid-template-columns: 1fr;
    }
    
    .button-group {
        flex-direction: column;
    }
    
    .btn {
        width: 100%;
    }
}
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>PVAMU ITS – Change Management Request (Borrador)</h1>
            <p>Formulario para solicitudes de cambios | Preparado para integración con GitHub Issues API</p>
        </div>

        <form id="changeRequestForm">
            <!-- SECTION 1: Datos del cambio -->
            <div class="section">
                <h2 class="section-title">1) Datos del cambio</h2>
                
                <div class="form-group">
                    <label class="form-label required" for="descripcion">Descripción:</label>
                    <textarea 
                        id="descripcion" 
                        name="descripcion" 
                        class="form-control" 
                        placeholder="Escriba la descripción del cambio..."
                        maxlength="500"
                        required></textarea>
                    <div class="char-counter" id="descripcionCounter">0 / 500 caracteres</div>
                    <div class="error-message" id="descripcionError">Este campo es requerido</div>
                </div>

                <div class="form-group">
                    <label class="form-label required" for="fecha_necesaria">Cambio requerido para (fecha):</label>
                    <input 
                        type="date" 
                        id="fecha_necesaria" 
                        name="fecha_necesaria" 
                        class="form-control"
                        required>
                    <div class="error-message" id="fecha_necesariaError">Este campo es requerido</div>
                </div>

                <div class="form-group">
                    <label class="form-label required" for="razon">Razón del cambio:</label>
                    <textarea 
                        id="razon" 
                        name="razon" 
                        class="form-control" 
                        placeholder="Explique por qué es necesario..."
                        required></textarea>
                    <div class="error-message" id="razonError">Este campo es requerido</div>
                </div>
            </div>

            <!-- SECTION 2: Tipo de cambio -->
            <div class="section">
                <h2 class="section-title">2) Tipo de cambio</h2>
                <p class="section-subtitle">Seleccione uno o varios:</p>
                
                <div class="checkbox-group">
                    <div class="checkbox-item">
                        <input type="checkbox" id="tipo_aplicacion" name="tipo_cambio" value="Aplicación">
                        <label for="tipo_aplicacion">Aplicación</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="tipo_bd" name="tipo_cambio" value="Base de Datos (BD)">
                        <label for="tipo_bd">Base de Datos (BD)</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="tipo_red" name="tipo_cambio" value="Red">
                        <label for="tipo_red">Red</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="tipo_seguridad" name="tipo_cambio" value="Seguridad">
                        <label for="tipo_seguridad">Seguridad</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="tipo_so" name="tipo_cambio" value="Sistema Operativo (SO)">
                        <label for="tipo_so">Sistema Operativo (SO)</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="tipo_outage" name="tipo_cambio" value="Schedule Outage / Parada">
                        <label for="tipo_outage">Schedule Outage / Parada</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="tipo_otro" name="tipo_cambio" value="Otro">
                        <label for="tipo_otro">Otro:</label>
                    </div>
                </div>
                
                <div class="otro-input" id="otroInputContainer">
                    <input 
                        type="text" 
                        id="tipo_otro_especificar" 
                        name="tipo_otro_especificar" 
                        class="form-control" 
                        placeholder="Especifique el tipo de cambio...">
                </div>
                <div class="error-message" id="tipoCambioError">Debe seleccionar al menos un tipo de cambio</div>
            </div>

            <!-- SECTION 3: Prioridad -->
            <div class="section">
                <h2 class="section-title">3) Prioridad</h2>
                <p class="section-subtitle">Seleccione una:</p>
                
                <div class="radio-group">
                    <div class="radio-item">
                        <input type="radio" id="prioridad_urgente" name="prioridad" value="Urgente" required>
                        <label for="prioridad_urgente">Urgente</label>
                    </div>
                    <div class="radio-item">
                        <input type="radio" id="prioridad_alta" name="prioridad" value="Alta">
                        <label for="prioridad_alta">Alta</label>
                    </div>
                    <div class="radio-item">
                        <input type="radio" id="prioridad_media" name="prioridad" value="Media">
                        <label for="prioridad_media">Media</label>
                    </div>
                    <div class="radio-item">
                        <input type="radio" id="prioridad_baja" name="prioridad" value="Baja">
                        <label for="prioridad_baja">Baja</label>
                    </div>
                </div>
                <div class="error-message" id="prioridadError">Debe seleccionar una prioridad</div>
            </div>

            <!-- SECTION 4: Change Impact Evaluation -->
            <div class="section">
                <h2 class="section-title">4) Impacto del Cambio</h2>
                
                <div class="form-group">
                    <label class="form-label required">Impacto:</label>
                    <div class="radio-group">
                        <div class="radio-item">
                            <input type="radio" id="impacto_menor" name="impacto" value="Menor" required>
                            <label for="impacto_menor">Menor</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" id="impacto_medio" name="impacto" value="Medio">
                            <label for="impacto_medio">Medio</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" id="impacto_mayor" name="impacto" value="Mayor">
                            <label for="impacto_mayor">Mayor</label>
                        </div>
                    </div>
                    <div class="error-message" id="impactoError">Este campo es requerido</div>
                </div>

                <div class="form-group">
                    <label class="form-label required" for="entornos_impactados">Entorno(s) impactado(s):</label>
                    <textarea 
                        id="entornos_impactados" 
                        name="entornos_impactados" 
                        class="form-control" 
                        placeholder="Ej: Producción, Desarrollo, QA..."
                        required></textarea>
                    <div class="error-message" id="entornos_impactadosError">Este campo es requerido</div>
                </div>

                <div class="form-group">
                    <label class="form-label required" for="recursos_requeridos">Recursos requeridos (personas, HW, SW):</label>
                    <textarea 
                        id="recursos_requeridos" 
                        name="recursos_requeridos" 
                        class="form-control" 
                        placeholder="Describa los recursos necesarios..."
                        required></textarea>
                    <div class="error-message" id="recursos_requeridosError">Este campo es requerido</div>
                </div>

                <div class="form-group">
                    <label class="form-label required" for="plan_prueba_rollback">Plan de prueba / Rollback (resumen):</label>
                    <textarea 
                        id="plan_prueba_rollback" 
                        name="plan_prueba_rollback" 
                        class="form-control" 
                        placeholder="Describa el plan de pruebas y rollback..."
                        required></textarea>
                    <div class="error-message" id="plan_prueba_rollbackError">Este campo es requerido</div>
                </div>
            </div>

            <!-- SECTION 5: Firmas -->
            <div class="section">
                <h2 class="section-title">5) Firmas (Requestor / Approval)</h2>
                <p class="section-subtitle">Incluya hasta 5 firmas (nombre, cargo, firma y fecha):</p>
                
                <div class="signature-grid">
                    <!-- Requestor -->
                    <div class="signature-block">
                        <div class="signature-block-title">1) Requestor:</div>
                        <div class="signature-fields">
                            <div class="form-group">
                                <label class="form-label required" for="requestor_nombre">Nombre:</label>
                                <input type="text" id="requestor_nombre" name="requestor_nombre" class="form-control" required>
                                <div class="error-message" id="requestor_nombreError">Este campo es requerido</div>
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="requestor_cargo">Cargo:</label>
                                <input type="text" id="requestor_cargo" name="requestor_cargo" class="form-control">
                            </div>
                            <div class="form-group">
                                <label class="form-label required" for="requestor_fecha">Fecha:</label>
                                <input type="date" id="requestor_fecha" name="requestor_fecha" class="form-control" required>
                                <div class="error-message" id="requestor_fechaError">Este campo es requerido</div>
                            </div>
                        </div>
                    </div>

                    <!-- Approval 1 -->
                    <div class="signature-block">
                        <div class="signature-block-title">2) Approval 1:</div>
                        <div class="signature-fields">
                            <div class="form-group">
                                <label class="form-label" for="approval1_nombre">Nombre:</label>
                                <input type="text" id="approval1_nombre" name="approval1_nombre" class="form-control">
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="approval1_cargo">Cargo:</label>
                                <input type="text" id="approval1_cargo" name="approval1_cargo" class="form-control">
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="approval1_fecha">Fecha:</label>
                                <input type="date" id="approval1_fecha" name="approval1_fecha" class="form-control">
                            </div>
                        </div>
                    </div>

                    <!-- Approval 2 -->
                    <div class="signature-block">
                        <div class="signature-block-title">3) Approval 2:</div>
                        <div class="signature-fields">
                            <div class="form-group">
                                <label class="form-label" for="approval2_nombre">Nombre:</label>
                                <input type="text" id="approval2_nombre" name="approval2_nombre" class="form-control">
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="approval2_cargo">Cargo:</label>
                                <input type="text" id="approval2_cargo" name="approval2_cargo" class="form-control">
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="approval2_fecha">Fecha:</label>
                                <input type="date" id="approval2_fecha" name="approval2_fecha" class="form-control">
                            </div>
                        </div>
                    </div>

                    <!-- Approval 3 -->
                    <div class="signature-block">
                        <div class="signature-block-title">4) Approval 3:</div>
                        <div class="signature-fields">
                            <div class="form-group">
                                <label class="form-label" for="approval3_nombre">Nombre:</label>
                                <input type="text" id="approval3_nombre" name="approval3_nombre" class="form-control">
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="approval3_cargo">Cargo:</label>
                                <input type="text" id="approval3_cargo" name="approval3_cargo" class="form-control">
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="approval3_fecha">Fecha:</label>
                                <input type="date" id="approval3_fecha" name="approval3_fecha" class="form-control">
                            </div>
                        </div>
                    </div>

                    <!-- Approval 4 -->
                    <div class="signature-block">
                        <div class="signature-block-title">5) Approval 4:</div>
                        <div class="signature-fields">
                            <div class="form-group">
                                <label class="form-label" for="approval4_nombre">Nombre:</label>
                                <input type="text" id="approval4_nombre" name="approval4_nombre" class="form-control">
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="approval4_cargo">Cargo:</label>
                                <input type="text" id="approval4_cargo" name="approval4_cargo" class="form-control">
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="approval4_fecha">Fecha:</label>
                                <input type="date" id="approval4_fecha" name="approval4_fecha" class="form-control">
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Form Actions -->
            <div class="button-group">
                <button type="submit" class="btn btn-primary">Enviar Solicitud</button>
                <button type="button" class="btn btn-secondary" id="clearFormBtn">Limpiar Formulario</button>
                <button type="button" class="btn btn-outline" id="viewSubmissionsBtn">Ver Solicitudes Guardadas</button>
            </div>
        </form>

        <!-- Submissions List -->
        <div class="submissions-list" id="submissionsList">
            <h3 style="margin-bottom: var(--space-16);">Solicitudes Guardadas</h3>
            <div id="submissionsContainer"></div>
        </div>

        <!-- GitHub API Integration Instructions -->
        <div class="collapsible">
            <div class="collapsible-header" id="githubInstructionsToggle">
                <span>📘 Instrucciones de Integración con GitHub API</span>
                <span>▼</span>
            </div>
            <div class="collapsible-content" id="githubInstructionsContent">
                <h3 style="margin-bottom: var(--space-16);">Cómo integrar este formulario con GitHub Issues</h3>
                
                <p style="margin-bottom: var(--space-12); color: var(--color-text-secondary);">Este formulario está preparado para enviar solicitudes de cambio directamente como GitHub Issues. Siga estos pasos:</p>

                <h4 style="margin: var(--space-20) 0 var(--space-12) 0;">1. Obtener Personal Access Token</h4>
                <p style="margin-bottom: var(--space-12); color: var(--color-text-secondary);">Vaya a GitHub → Settings → Developer settings → Personal access tokens → Generate new token</p>
                <p style="margin-bottom: var(--space-12); color: var(--color-text-secondary);">Permisos necesarios: <code>repo</code> (acceso completo a repositorios)</p>

                <h4 style="margin: var(--space-20) 0 var(--space-12) 0;">2. Endpoint de la API</h4>
                <div class="code-block">POST https://api.github.com/repos/{owner}/{repo}/issues</div>

                <h4 style="margin: var(--space-20) 0 var(--space-12) 0;">3. Headers requeridos</h4>
                <div class="code-block">{
  "Authorization": "Bearer YOUR_GITHUB_TOKEN",
  "Content-Type": "application/json",
  "Accept": "application/vnd.github+json"
}</div>

                <h4 style="margin: var(--space-20) 0 var(--space-12) 0;">4. Ejemplo de código JavaScript</h4>
                <div class="code-block">async function createGitHubIssue(formData) {
  const response = await fetch('https://api.github.com/repos/OWNER/REPO/issues', {
    method: 'POST',
    headers: {
      'Authorization': 'Bearer YOUR_TOKEN',
      'Content-Type': 'application/json',
      'Accept': 'application/vnd.github+json'
    },
    body: JSON.stringify({
      title: formData.title,
      body: formData.body,
      labels: formData.labels
    })
  });
  
  return await response.json();
}</div>

                <h4 style="margin: var(--space-20) 0 var(--space-12) 0;">5. Estructura del Body</h4>
                <p style="margin-bottom: var(--space-12); color: var(--color-text-secondary);">El formulario formatea automáticamente los datos en markdown. Los labels se generan automáticamente basados en prioridad, tipo de cambio e impacto.</p>
            </div>
        </div>

        <!-- Note -->
        <div class="note">
            <strong>Nota:</strong> Este sistema es excelente para clasificar y priorizar de forma operativa. Los datos se almacenan temporalmente en memoria y están preparados para ser enviados a GitHub Issues API.
        </div>
    </div>

    <!-- Success Modal -->
    <div class="modal" id="successModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Solicitud Enviada Exitosamente</h2>
                <button class="close-btn" id="closeSuccessModal">&times;</button>
            </div>
            <div id="successModalBody"></div>
        </div>
    </div>

    <!-- Detail Modal -->
    <div class="modal" id="detailModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Detalle de Solicitud</h2>
                <button class="close-btn" id="closeDetailModal">&times;</button>
            </div>
            <div id="detailModalBody"></div>
        </div>
    </div>

    <script>
        // In-memory storage for submissions
        let submissions = [];
        let submissionIdCounter = 1;

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            setupEventListeners();
            updateCharCounter();
        });

        function setupEventListeners() {
            // Form submission
            document.getElementById('changeRequestForm').addEventListener('submit', handleFormSubmit);
            
            // Clear form button
            document.getElementById('clearFormBtn').addEventListener('click', clearForm);
            
            // View submissions button
            document.getElementById('viewSubmissionsBtn').addEventListener('click', toggleSubmissionsList);
            
            // GitHub instructions toggle
            document.getElementById('githubInstructionsToggle').addEventListener('click', toggleGithubInstructions);
            
            // Otro checkbox
            document.getElementById('tipo_otro').addEventListener('change', function() {
                const otroInput = document.getElementById('otroInputContainer');
                if (this.checked) {
                    otroInput.classList.add('visible');
                } else {
                    otroInput.classList.remove('visible');
                    document.getElementById('tipo_otro_especificar').value = '';
                }
            });
            
            // Character counter
            document.getElementById('descripcion').addEventListener('input', updateCharCounter);
            
            // Modal close buttons
            document.getElementById('closeSuccessModal').addEventListener('click', () => {
                document.getElementById('successModal').classList.remove('visible');
            });
            document.getElementById('closeDetailModal').addEventListener('click', () => {
                document.getElementById('detailModal').classList.remove('visible');
            });
            
            // Close modals on outside click
            document.getElementById('successModal').addEventListener('click', function(e) {
                if (e.target === this) {
                    this.classList.remove('visible');
                }
            });
            document.getElementById('detailModal').addEventListener('click', function(e) {
                if (e.target === this) {
                    this.classList.remove('visible');
                }
            });
        }

        function updateCharCounter() {
            const textarea = document.getElementById('descripcion');
            const counter = document.getElementById('descripcionCounter');
            const length = textarea.value.length;
            counter.textContent = `${length} / 500 caracteres`;
            
            if (length > 450) {
                counter.classList.add('warning');
            } else {
                counter.classList.remove('warning');
            }
        }

        function handleFormSubmit(e) {
            e.preventDefault();
            
            // Clear previous errors
            clearErrors();
            
            // Validate form
            if (!validateForm()) {
                return;
            }
            
            // Collect form data
            const formData = collectFormData();
            
            // Store submission
            const submission = {
                id: submissionIdCounter++,
                timestamp: new Date().toISOString(),
                data: formData
            };
            submissions.push(submission);
            
            // Show success message
            showSuccessModal(submission);
            
            // Clear form
            clearForm();
        }

        function validateForm() {
            let isValid = true;
            
            // Section 1: Datos del cambio
            if (!document.getElementById('descripcion').value.trim()) {
                showError('descripcion');
                isValid = false;
            }
            if (!document.getElementById('fecha_necesaria').value) {
                showError('fecha_necesaria');
                isValid = false;
            }
            if (!document.getElementById('razon').value.trim()) {
                showError('razon');
                isValid = false;
            }
            
            // Section 2: Tipo de cambio
            const tipoCheckboxes = document.querySelectorAll('input[name="tipo_cambio"]:checked');
            if (tipoCheckboxes.length === 0) {
                showError('tipoCambio');
                isValid = false;
            }
            
            // Section 3: Prioridad
            const prioridad = document.querySelector('input[name="prioridad"]:checked');
            if (!prioridad) {
                showError('prioridad');
                isValid = false;
            }
            
            // Section 4: Change Impact Evaluation
            const impacto = document.querySelector('input[name="impacto"]:checked');
            if (!impacto) {
                showError('impacto');
                isValid = false;
            }
            if (!document.getElementById('entornos_impactados').value.trim()) {
                showError('entornos_impactados');
                isValid = false;
            }
            if (!document.getElementById('recursos_requeridos').value.trim()) {
                showError('recursos_requeridos');
                isValid = false;
            }
            if (!document.getElementById('plan_prueba_rollback').value.trim()) {
                showError('plan_prueba_rollback');
                isValid = false;
            }
            
            // Section 5: Firmas (at minimum, requestor)
            if (!document.getElementById('requestor_nombre').value.trim()) {
                showError('requestor_nombre');
                isValid = false;
            }
            if (!document.getElementById('requestor_fecha').value) {
                showError('requestor_fecha');
                isValid = false;
            }
            
            return isValid;
        }

        function showError(fieldId) {
            const field = document.getElementById(fieldId);
            const error = document.getElementById(fieldId + 'Error');
            if (field) field.classList.add('error');
            if (error) error.classList.add('visible');
        }

        function clearErrors() {
            document.querySelectorAll('.error-message').forEach(el => el.classList.remove('visible'));
            document.querySelectorAll('.form-control.error').forEach(el => el.classList.remove('error'));
        }

        function collectFormData() {
            // Collect tipo de cambio
            const tiposCambio = [];
            document.querySelectorAll('input[name="tipo_cambio"]:checked').forEach(cb => {
                tiposCambio.push(cb.value);
            });
            
            // If "Otro" is checked, add the custom value
            if (document.getElementById('tipo_otro').checked) {
                const otroValue = document.getElementById('tipo_otro_especificar').value;
                if (otroValue) {
                    tiposCambio.push(`Otro: ${otroValue}`);
                }
            }
            
            // Collect all approvals
            const approvals = [];
            for (let i = 1; i <= 4; i++) {
                const nombre = document.getElementById(`approval${i}_nombre`).value;
                if (nombre) {
                    approvals.push({
                        nombre: nombre,
                        cargo: document.getElementById(`approval${i}_cargo`).value,
                        fecha: document.getElementById(`approval${i}_fecha`).value
                    });
                }
            }
            
            return {
                descripcion: document.getElementById('descripcion').value,
                fecha_necesaria: document.getElementById('fecha_necesaria').value,
                razon: document.getElementById('razon').value,
                tipo_cambio: tiposCambio,
                prioridad: document.querySelector('input[name="prioridad"]:checked').value,
                impacto: document.querySelector('input[name="impacto"]:checked').value,
                entornos_impactados: document.getElementById('entornos_impactados').value,
                recursos_requeridos: document.getElementById('recursos_requeridos').value,
                plan_prueba_rollback: document.getElementById('plan_prueba_rollback').value,
                requestor: {
                    nombre: document.getElementById('requestor_nombre').value,
                    cargo: document.getElementById('requestor_cargo').value,
                    fecha: document.getElementById('requestor_fecha').value
                },
                approvals: approvals
            };
        }

        function formatGitHubIssue(submission) {
            const data = submission.data;
            
            // Create title (truncate description to 50 chars)
            const title = `Change Request - ${data.descripcion.substring(0, 50)}${data.descripcion.length > 50 ? '...' : ''}`;
            
            // Generate labels
            const labels = [
                'change-request',
                `priority-${data.prioridad.toLowerCase()}`,
                `impact-${data.impacto.toLowerCase()}`
            ];
            
            // Add tipo de cambio as labels
            data.tipo_cambio.forEach(tipo => {
                const label = tipo.toLowerCase().replace(/\s+/g, '-').replace(/[()]/g, '');
                labels.push(label);
            });
            
            // Format body in markdown
            let body = `# Change Management Request\n\n`;
            body += `**Submission ID:** ${submission.id}\n`;
            body += `**Submitted:** ${new Date(submission.timestamp).toLocaleString('es-ES')}\n\n`;
            
            body += `## 1. Datos del cambio\n\n`;
            body += `**Descripción:**\n${data.descripcion}\n\n`;
            body += `**Change needed by:** ${data.fecha_necesaria}\n\n`;
            body += `**Razón del cambio:**\n${data.razon}\n\n`;
            
            body += `## 2. Tipo de cambio\n\n`;
            data.tipo_cambio.forEach(tipo => {
                body += `- ${tipo}\n`;
            });
            body += `\n`;
            
            body += `## 3. Prioridad\n\n`;
            body += `**${data.prioridad}**\n\n`;
            
            body += `## 4. Change Impact Evaluation\n\n`;
            body += `**Impacto:** ${data.impacto}\n\n`;
            body += `**Entorno(s) impactado(s):**\n${data.entornos_impactados}\n\n`;
            body += `**Recursos requeridos:**\n${data.recursos_requeridos}\n\n`;
            body += `**Plan de prueba / Rollback:**\n${data.plan_prueba_rollback}\n\n`;
            
            body += `## 5. Firmas\n\n`;
            body += `**Requestor:**\n`;
            body += `- Nombre: ${data.requestor.nombre}\n`;
            if (data.requestor.cargo) body += `- Cargo: ${data.requestor.cargo}\n`;
            body += `- Fecha: ${data.requestor.fecha}\n\n`;
            
            if (data.approvals.length > 0) {
                body += `**Approvals:**\n\n`;
                data.approvals.forEach((approval, index) => {
                    body += `${index + 1}. **${approval.nombre}**\n`;
                    if (approval.cargo) body += `   - Cargo: ${approval.cargo}\n`;
                    body += `   - Fecha: ${approval.fecha}\n\n`;
                });
            }
            
            return { title, body, labels };
        }

        function showSuccessModal(submission) {
            const githubIssue = formatGitHubIssue(submission);
            
            let html = '<div class="success-message">';
            html += '<h3>✓ Solicitud guardada exitosamente</h3>';
            html += `<p>ID de solicitud: <strong>#${submission.id}</strong></p>`;
            html += `<p>Fecha y hora: ${new Date(submission.timestamp).toLocaleString('es-ES')}</p>`;
            html += '</div>';
            
            html += '<div class="github-preview">';
            html += '<h4>Vista previa para GitHub Issues:</h4>';
            html += '<p style="margin: var(--space-12) 0;"><strong>Título:</strong></p>';
            html += `<pre>${githubIssue.title}</pre>`;
            html += '<p style="margin: var(--space-12) 0;"><strong>Labels:</strong></p>';
            html += `<pre>${githubIssue.labels.join(', ')}</pre>`;
            html += '<p style="margin: var(--space-12) 0;"><strong>Body (primeras 500 caracteres):</strong></p>';
            html += `<pre>${githubIssue.body.substring(0, 500)}...</pre>`;
            html += '</div>';
            
            html += '<p style="margin-top: var(--space-16); color: var(--color-text-secondary);">Para enviar esta solicitud a GitHub, use la API con el token y repositorio configurados. Ver las instrucciones de integración al final del formulario.</p>';
            
            document.getElementById('successModalBody').innerHTML = html;
            document.getElementById('successModal').classList.add('visible');
        }

        function clearForm() {
            document.getElementById('changeRequestForm').reset();
            document.getElementById('otroInputContainer').classList.remove('visible');
            clearErrors();
            updateCharCounter();
        }

        function toggleSubmissionsList() {
            const list = document.getElementById('submissionsList');
            list.classList.toggle('visible');
            
            if (list.classList.contains('visible')) {
                renderSubmissionsList();
            }
        }

        function renderSubmissionsList() {
            const container = document.getElementById('submissionsContainer');
            
            if (submissions.length === 0) {
                container.innerHTML = '<div class="empty-state">No hay solicitudes guardadas todavía.</div>';
                return;
            }
            
            let html = '';
            // Show newest first
            const sortedSubmissions = [...submissions].reverse();
            
            sortedSubmissions.forEach(submission => {
                const data = submission.data;
                html += '<div class="submission-item">';
                html += '<div class="submission-info">';
                html += `<strong>#${submission.id} - ${data.descripcion.substring(0, 60)}${data.descripcion.length > 60 ? '...' : ''}</strong>`;
                html += `<small>Prioridad: ${data.prioridad} | Impacto: ${data.impacto} | ${new Date(submission.timestamp).toLocaleString('es-ES')}</small>`;
                html += '</div>';
                html += `<button class="btn btn-outline" onclick="showDetailModal(${submission.id})">Ver Detalles</button>`;
                html += '</div>';
            });
            
            container.innerHTML = html;
        }

        function showDetailModal(submissionId) {
            const submission = submissions.find(s => s.id === submissionId);
            if (!submission) return;
            
            const githubIssue = formatGitHubIssue(submission);
            const data = submission.data;
            
            let html = '<div style="color: var(--color-text);">';
            html += `<p style="margin-bottom: var(--space-16); color: var(--color-text-secondary);"><strong>ID:</strong> #${submission.id} | <strong>Enviado:</strong> ${new Date(submission.timestamp).toLocaleString('es-ES')}</p>`;
            
            html += '<h3 style="margin: var(--space-20) 0 var(--space-12) 0; font-size: var(--font-size-lg);">Datos del cambio</h3>';
            html += `<p><strong>Descripción:</strong><br>${data.descripcion}</p>`;
            html += `<p><strong>Fecha necesaria:</strong> ${data.fecha_necesaria}</p>`;
            html += `<p><strong>Razón:</strong><br>${data.razon}</p>`;
            
            html += '<h3 style="margin: var(--space-20) 0 var(--space-12) 0; font-size: var(--font-size-lg);">Tipo de cambio</h3>';
            html += '<ul style="margin-left: var(--space-20);">';
            data.tipo_cambio.forEach(tipo => {
                html += `<li>${tipo}</li>`;
            });
            html += '</ul>';
            
            html += '<h3 style="margin: var(--space-20) 0 var(--space-12) 0; font-size: var(--font-size-lg);">Prioridad</h3>';
            html += `<p><strong>${data.prioridad}</strong></p>`;
            
            html += '<h3 style="margin: var(--space-20) 0 var(--space-12) 0; font-size: var(--font-size-lg);">Change Impact Evaluation</h3>';
            html += `<p><strong>Impacto:</strong> ${data.impacto}</p>`;
            html += `<p><strong>Entornos impactados:</strong><br>${data.entornos_impactados}</p>`;
            html += `<p><strong>Recursos requeridos:</strong><br>${data.recursos_requeridos}</p>`;
            html += `<p><strong>Plan de prueba/Rollback:</strong><br>${data.plan_prueba_rollback}</p>`;
            
            html += '<h3 style="margin: var(--space-20) 0 var(--space-12) 0; font-size: var(--font-size-lg);">Firmas</h3>';
            html += `<p><strong>Requestor:</strong> ${data.requestor.nombre}`;
            if (data.requestor.cargo) html += ` (${data.requestor.cargo})`;
            html += ` - ${data.requestor.fecha}</p>`;
            
            if (data.approvals.length > 0) {
                html += '<p><strong>Approvals:</strong></p><ul style="margin-left: var(--space-20);">';
                data.approvals.forEach((approval, index) => {
                    html += `<li>${approval.nombre}`;
                    if (approval.cargo) html += ` (${approval.cargo})`;
                    html += ` - ${approval.fecha}</li>`;
                });
                html += '</ul>';
            }
            
            html += '<div class="github-preview" style="margin-top: var(--space-24);">';
            html += '<h4>Formato para GitHub Issues:</h4>';
            html += `<p style="margin: var(--space-12) 0;"><strong>Título:</strong> ${githubIssue.title}</p>`;
            html += `<p style="margin: var(--space-12) 0;"><strong>Labels:</strong> ${githubIssue.labels.join(', ')}</p>`;
            html += '</div>';
            
            html += '</div>';
            
            document.getElementById('detailModalBody').innerHTML = html;
            document.getElementById('detailModal').classList.add('visible');
        }

        function toggleGithubInstructions() {
            const content = document.getElementById('githubInstructionsContent');
            content.classList.toggle('visible');
        }
    </script>
</body>
</html>
